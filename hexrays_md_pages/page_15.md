# Hex-Rays Blog – Page 15

**Archived:** 2026-02-20 12:14
**URL:** https://hex-rays.com/blog/page/15

---

## 1. 

**Date:** Posted: Apr 18, 2023  
**Link:** [https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge-day-2](https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge-day-2)

[Back](<https://hex-rays.com/blog>)

[Trivia](<https://hex-rays.com/blog/tag/trivia>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>) [Quiz](<https://hex-rays.com/blog/tag/quiz>)

# IDA Trivia – Test your IDA knowledge! DAY 2

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge-day-2>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge-day-2>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge-day-2>)

Geoffrey Czokow ✦ Posted: Apr 18, 2023

![IDA Trivia – Test your IDA knowledge! DAY 2](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-44-11-9294-AM.png)

The **#IDATrivia game! – Day 2**

All questions are be related to IDA. Read them carefully, check our website, take a look at Igor’s tips, and send your guesses to [marketing@hex-rays.com](<mailto:marketing@hex-rays.com>).  
**Attention!** Submissions made after the deadlines will not be considered. The deadlines will be published with each round of questions. If all your answers are correct, you will participate in a raffle, and on the following day, we will pick and announce a winner. Each day we will give a different prize. Wondering what the awards are? That’s a mystery… and we will keep it secret. If you win, you will find out what your prize is at the time of the delivery.

If you think you are an IDA whiz, this should be a walk in the park for you. So let’s find that out…

###  **Round 2**

**Date: 18 April**

**Questions:**

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/trivia_blog_2-3.png?width=689&height=324&name=trivia_blog_2-3.png)

3\. What shortcut could you use to jump to the matching brace in the decompiler?  
4\. What does the red highlighting in the decompiler mean?

**Deadline for submissions:[19 April, 1 pm CEST](<https://www.timeanddate.com/worldclock/converter.html?iso=20230419T110000&p1=137&p2=179&p3=136&p4=48&p5=49&p6=tz_jst&p7=240>)**

### **General Terms & Conditions:**

[See the initial post](<https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge/>)

Should you have any complaints or questions, please get in touch with [marketing@hex-rays.com ](<mailto:marketing@hex-rays.com>)

---

## 2. 

**Date:** Posted: Apr 17, 2023  
**Link:** [https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge](https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge)

[Back](<https://hex-rays.com/blog>)

[Trivia](<https://hex-rays.com/blog/tag/trivia>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>) [Quiz](<https://hex-rays.com/blog/tag/quiz>)

# IDA Trivia – Test your IDA knowledge!

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/ida-trivia-test-your-ida-knowledge>)

A 

Alex Petrov ✦ Posted: Apr 17, 2023

![IDA Trivia – Test your IDA knowledge!](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-52-18-9716-AM.png)

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/ida_trivia-3.png?width=1200&height=675&name=ida_trivia-3.png)

The Easter holidays have passed, and you might think we have forgotten to create a challenge. Good news! **There will be a game** , and it will last for 5 days. Ready? Here is the deal…

The **#IDATrivia game**! Starting today, we will post a pair of questions each day **until Friday, 21 April**. All questions will be related to IDA. Read them carefully, check our website, take a look at Igor’s tips, and send your guesses to [marketing@hex-rays.com](<mailto:marketing@hex-rays.com>). **Attention!** Submissions made after the deadlines will not be considered. The deadlines will be published with each round of questions. If all your answers are correct, you will participate in a raffle, and on the following day, we will pick and announce a winner. Each day we will give a different prize. Wondering what the awards are? That’s a mystery… and we will keep it secret. If you win, you will find out what your prize is at the time of the delivery. 

If you think you are an IDA whiz, this should be a walk in the park for you. So let’s find that out…

###  **Round 1**

**Date: 17 April**

**Questions:**

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/trivia_blog_1-3.png?width=689&height=324&name=trivia_blog_1-3.png)

1\. When was the first actual release of IDA?   
2\. What are the three main search options in IDA?

**Deadline for submissions: 18 April, 11 am CEST**

### **General Terms & Conditions:**

  * This challenge is completely free and does not require a purchase of a product or service;
  * The winners will be contacted to provide a full delivery address. If we do not receive complete delivery information, we will consider the submission unsuccessful and select another winner.
  * The gifts will be sent within a week after the announcement. The delivery is free of charge for the winner.
  * All personal data, including email addresses, names, and shipping details, will not be: 
    * Given to third parties;
    * Used for further communication;
    * Stored on our servers longer than the duration of the challenge.



Should you have any complaints or questions, please get in touch with [marketing@hex-rays.com ](<mailto:marketing@hex-rays.com>)

---

## 3. 

**Date:** Posted: Apr 14, 2023  
**Link:** [https://hex-rays.com/blog/igors-tip-of-the-week-136-changing-assembler-syntax](https://hex-rays.com/blog/igors-tip-of-the-week-136-changing-assembler-syntax)

[Back](<https://hex-rays.com/blog>)

[idapro](<https://hex-rays.com/blog/tag/idapro>) [idatips](<https://hex-rays.com/blog/tag/idatips>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>)

# Igor’s Tip of the Week #136: Changing assembler syntax

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/igors-tip-of-the-week-136-changing-assembler-syntax>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/igors-tip-of-the-week-136-changing-assembler-syntax>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/igors-tip-of-the-week-136-changing-assembler-syntax>)

I 

Igor Skochinsky ✦ Posted: Apr 14, 2023

![Igor’s Tip of the Week #136: Changing assembler syntax](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-44-11-9294-AM.png)

When [exporting disassembly](<https://hex-rays.com/blog/igors-tip-of-the-week-135-exporting-disassembly-from-ida/>), sometimes you need to modify it so that it is accepted by a specific assembler you’re using. One little-known fact is that some of IDA’s processor modules support different assembler syntaxes, so it may be useful to try a different one to see if it matches your needs better.

The assembler can be changed via Options > General…, Analysis tab:

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmsyntax1-3.png?width=781&height=706&name=asmsyntax1-3.png)

For example, on x86 the TASM Ideal syntax may be selected instead of the default Generic one (based on MASM). One feature of this syntax is that it always uses brackets for instructions which dereference memory pointers.

For ARM, you can choose a legacy assembler, which was used before introduction of UAL (unified assembly language) with Thumb-2. For example, it used explicit `STMFD` and `LDMFD` instructions instead of the more convenient `PUSH` and `POP` introduced for Thumb. 

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmsyntax2-3.png?width=1231&height=239&name=asmsyntax2-3.png)

Nowadays, IDA defaults to the generic UAL assembler which is de-facto standard and easier to read.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmsyntax4-3.png?width=940&height=209&name=asmsyntax4-3.png)

For some of the older processors the selection of assemblers can be quite extensive; they often didn’t have a freely available official assembler so many third-party alternatives were available.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmsyntax3-3.png?width=781&height=706&name=asmsyntax3-3.png)

---

## 4. 

**Date:** Posted: Apr 7, 2023  
**Link:** [https://hex-rays.com/blog/igors-tip-of-the-week-135-exporting-disassembly-from-ida](https://hex-rays.com/blog/igors-tip-of-the-week-135-exporting-disassembly-from-ida)

[Back](<https://hex-rays.com/blog>)

[idapro](<https://hex-rays.com/blog/tag/idapro>) [shortcuts](<https://hex-rays.com/blog/tag/shortcuts>) [idatips](<https://hex-rays.com/blog/tag/idatips>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>)

# Igor’s Tip of the Week #135: Exporting disassembly from IDA

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/igors-tip-of-the-week-135-exporting-disassembly-from-ida>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/igors-tip-of-the-week-135-exporting-disassembly-from-ida>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/igors-tip-of-the-week-135-exporting-disassembly-from-ida>)

I 

Igor Skochinsky ✦ Posted: Apr 7, 2023

![Igor’s Tip of the Week #135: Exporting disassembly from IDA](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-44-11-9294-AM.png)

Although most of the time you can probably do all of the reversing inside IDA, occasionally you may need to continue it using other tools. While sometimes it may be enough to analyze the input file with another tool, or use the [Export Data](<https://hex-rays.com/blog/igors-tip-of-the-week-39-export-data/>) feature, the disassembly listing is more convenient in many cases. Of course, you can use the clipboard to copy some snippets, but this can be awkward and slow if you need big chunks of the listing, or need to remove unnecessary parts of the listing such as the address prefixes.

### ASM file

ASM files can be generated by using the menu entry File > Produce File > Create ASM File…, or the shortcut `Alt`–`F10`.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmexport1-3.png?width=1396&height=187&name=asmexport1-3.png)

By default, the contents of the whole database is exported, but you can [select a range](<https://hex-rays.com/blog/igor-tip-of-the-week-03-selection-in-ida/>) before invoking the command to limit it to just what you need. If you need multiple fragments, you can repeat the action several time, choosing “Append” when IDA informs you that the file already exists.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmexport2-3.png?width=665&height=179&name=asmexport2-3.png)

In ideal circumstances, the ASM listing can be passed to the assembler to generate code equivalent to the original binary. It means it does not contain extra annotations which may be present in IDA, such as address prefixes or [opcode bytes](<https://hex-rays.com/blog/igors-tip-of-the-week-123-opcode-bytes/>). Of course, the reality is often not so simple, but minor modification to the ASM file may be enough to solve your problem.

### LST file

The LST file can be generated via the menu entry File > Produce File > Create LST File… (no default shortcut). Unlike the ASM file, it contains all the information present in IDA’s text view, so it can be useful if you want to see [opcode bytes](<https://hex-rays.com/blog/igors-tip-of-the-week-123-opcode-bytes/>) or address prefixes.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/asmexport3-3.png?width=1335&height=669&name=asmexport3-3.png)

### Protip

The ASM or LST file usually needs at least one line of text per each instruction or data item. If your database contains large data areas, converting them to [arrays](<https://hex-rays.com/blog/igor-tip-of-the-week-10-working-with-arrays/>) before exporting can reduce the size of the output files significantly. [Hiding or collapsing](<https://hex-rays.com/blog/igors-tip-of-the-week-31-hiding-and-collapsing/>) uninteresting areas or whole segments is another option.

---

## 5. 

**Date:** Posted: Mar 31, 2023  
**Link:** [https://hex-rays.com/blog/igors-tip-of-the-week-134-arm-bl-jumps](https://hex-rays.com/blog/igors-tip-of-the-week-134-arm-bl-jumps)

[Back](<https://hex-rays.com/blog>)

[idapro](<https://hex-rays.com/blog/tag/idapro>) [idatips](<https://hex-rays.com/blog/tag/idatips>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>) [ARM](<https://hex-rays.com/blog/tag/arm>)

# Igor’s Tip of the Week #134: ARM BL jumps

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/igors-tip-of-the-week-134-arm-bl-jumps>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/igors-tip-of-the-week-134-arm-bl-jumps>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/igors-tip-of-the-week-134-arm-bl-jumps>)

I 

Igor Skochinsky ✦ Posted: Mar 31, 2023

![Igor’s Tip of the Week #134: ARM BL jumps](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-52-18-9716-AM.png)

If you ever looked at IDA ARM module’s [processor-specific settings](<https://hex-rays.com/blog/igors-tip-of-the-week-98-analysis-options/>), you may have been puzzled by the option “Disable BL jumps detection”.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/bl_jump1-3.png?width=426&height=555&name=bl_jump1-3.png)

What is it and when to use it?

### Background

The ARM instruction set initially used fixed-width 32-bit instructions. The relative branch instruction, **B** , allocated 24 bits for the offset, giving it a range of ±32MB.

Some time later, ARM introduced a a compact 16-bit encoding for a subset of instructions, called Thumb. Because most relative branches occur in the same function, the ±2KB range available for 16-bit **B** instructions was usually enough. In case longer distance was needed, a longer instruction sequence would have to be generated.

Some compiler writers realized, that the **BL** instruction, normally used for function calls, can be used for simple branches as well. On ARM, the function calls do not use the stack, so the only side effect of BL as opposed to simple branch is that it sets the LR register to the address following the BL instruction. If the LR is saved at the start of the current function, it does not matter that if LR is clobbered by the intermediate BL instructions, since it can be restored from the saved area to return to the caller. The BL is encoded as pair of 16-bit instructions, which gives it a range of ±4MB.

A later extension of the Thumb, called Thumb-2, introduced a 32-bit version of B, giving it a range of ±16MB, so there is less need of such tricks in code compiled for modern processors which support Thumb-2. However, old code still needs to be analyzed sometimes, so it may be necessary to support such usage of **BL**. 

### Example

Here’s an example of a Thumb mode program which looks a little strange…

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/bl_jump2-3.png?width=809&height=370&name=bl_jump2-3.png)

IDA has created a function because of the BL instruction which normally implies a function call. But we see that `func` is not complete, so most likely `sub_C` is actually its continuation and BL is used only as a branch. Also, `func` saves LR on the stack, so BL clobbering it does not matter.

### Marking single instructions

If the BL-as-branch approach is used only in few cases, you can handle them manually. For this, place the cursor on the line with BL and use Edit > Other > Force BL jump menu item. IDA will take this into account and indicate that this BL does not continue to the next instruction by adding a [dashed comment line after it](<https://hex-rays.com/blog/igors-tip-of-the-week-126-non-returning-functions/>). 

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/bl_jump3-3.png?width=604&height=58&name=bl_jump3-3.png)

You can then delete the wrongly created function and [extend](<https://hex-rays.com/blog/igors-tip-of-the-week-127-changing-function-bounds/>) or recreate the original one which had been truncated.

### Changing analysis behavior

If the binary has multiple functions which use this technique, it may be worth it to let the analyzer check each BL destination before creating functions. For this, turn off _Disable BL jumps detection_ in the processor specific options and [reanalyze the program](<https://hex-rays.com/blog/igor-tip-of-the-week-09-reanalysis/>). Note that you will likely have to delete the wrongly created functions, so it may be better to reload the file, changing the options in the initial Load File dialog.

To set this by default, change `ARM_DISABLE_BL_JUMPS` value in `ida.cfg`.

In cases where the BL jumps detection fails (it marks a BL as a jump where it should be a call, or vice versa), you can always override its decision using Force BL jump and Force BL call menu options. In case you discover a specific code pattern and need to script it, you can also use[ IDC functions](<https://www.hex-rays.com/products/ida/support/idadoc/681.shtml>) `force_bl_jump(ea)` and `force_bl_call(ea)`.

---

## 6. 

**Date:** Posted: Mar 24, 2023  
**Link:** [https://hex-rays.com/blog/igors-tip-of-the-week-133-alignment-items](https://hex-rays.com/blog/igors-tip-of-the-week-133-alignment-items)

[Back](<https://hex-rays.com/blog>)

[idapro](<https://hex-rays.com/blog/tag/idapro>) [shortcuts](<https://hex-rays.com/blog/tag/shortcuts>) [idatips](<https://hex-rays.com/blog/tag/idatips>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>)

# Igor’s Tip of the Week #133: Alignment items

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/igors-tip-of-the-week-133-alignment-items>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/igors-tip-of-the-week-133-alignment-items>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/igors-tip-of-the-week-133-alignment-items>)

I 

Igor Skochinsky ✦ Posted: Mar 24, 2023

![Igor’s Tip of the Week #133: Alignment items](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-44-11-9294-AM.png)

Sometimes you may see mysterious `align` keywords in the disassembly, which can appear both in code and data areas:

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align1-3.png?width=1142&height=624&name=align1-3.png)

Usually they’re only apparent in the text view.

These directives are used by many assemblers to indicate alignment to a specific address boundary, usually a power of two. IDA uses it to replace potentially irrelevant bytes by a short one-liner, both for more compact listing and to indicate that this part of the binary is probably not interesting. 

Depending on the processor and the assembler chosen, different keyword can be used (e.g. `align` or `.align`), and the number after the directive can mean either the number of bytes or the power of two (i.e. 1 means aligning to two bytes, 2 to four, 4 to sixteen and so on).

The alignment items can appear in the following situations:

### Code alignment padding

Many processors use instruction caches which speed up execution of often-executed code (for example, loops). This is why it may be useful to ensure that start of a loop is aligned on a specific address boundary (usually 16 bytes). For this, the compiler needs to insert instructions which do not affect the behavior of the function, i.e. NOP (no-operation) instructions. Which specific instructions are used depends on the processor and compiler. 

For example, here GCC used a so-called “long NOP” to align the loop on 16 bytes (obvious thanks to the hexadecimal address ending with 0). Because this instruction is actually executed, IDA shows it as code and not as an align expression (which is considered non-executable and would break disassembly), but you can still convert it manually.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align2-3.png?width=976&height=578&name=align2-3.png)

There may also be hardware requirements. On some processors the interrupt handlers must be aligned, like in this example from PowerPC:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align8-3.png?width=710&height=504&name=align8-3.png)

Here, 4 is a power-of-two value, i.e. alignment to 16-byte boundary.

### Function padding

Similarly to loops, whole functions can benefit from the alignment, so they’re commonly (but not always!) aligned to at least four bytes. Because the functions are usually placed one after the other but the function size is not always a multiple of the alignment, extra padding has to be inserted by the compiler and/or the linker. Two common approaches are used:

  1. executable NOP instructions, just like for the loop alignment. This is the approach commonly used by GCC and derived compilers:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align3-3.png?width=1133&height=369&name=align3-3.png)
  2. invalid or trapping instructions. This can be useful to catch bugs where execution is diverted to an address between functions, for example due to a bug or an exploit. Microsoft Visual C++, for example, tends to use 0xCC (breakpoint instruction) to pad the space between functions on x86:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align4-3.png?width=1277&height=641&name=align4-3.png)



### Data alignment padding

Many processors have alignment requirements: some can’t even load data from unaligned addresses, and others can usually fetch aligned data faster. So the compilers often try to ensure that data items are placed on an aligned address boundary (usually at least 4 bytes). Most commonly, zero-fill padding is used:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align5-3.png?width=1277&height=298&name=align5-3.png)

Although NOP-like fillers may be used by some compilers too, especially for constant data placed in executable areas:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align6-3.png?width=1339&height=527&name=align6-3.png)

## Converting alignment items

While rare, it may be necessary for you to change IDA’s decision concerning an alignment item. Because they’re mostly equivalent to data items, you can use the usual shortcut `U` to undefine them (convert to plain bytes), and then `C` to convert to code (in case they correspond to valid instructions).

To go the other way (convert instructions or undefined bytes) to an alignment item, use Edit > Other > Create alignment directive…, or just the shortcut `L`. IDA will check at what address is the next defined instruction or data item and will offer possibly several alignment options depending on its address. For example, in this situation:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/align7-3.png?width=1271&height=302&name=align7-3.png)  
The current address is divisible by 4 so any alignment less than 4 is not applicable. The following defined address ( `7FF674A1A20`) is divisible by 32, so IDA offers options 8, 16 and 32. Note that if you choose 8, the alignment item will only cover the first 4 bytes (up to `7FF674A1A18`), so in this situation 16 or 32 makes the most sense.

---

## 7. 

**Date:** Posted: Mar 20, 2023  
**Link:** [https://hex-rays.com/blog/plugin-focus-sk3wldbg](https://hex-rays.com/blog/plugin-focus-sk3wldbg)

[Back](<https://hex-rays.com/blog>)

[plugin](<https://hex-rays.com/blog/tag/plugin>) [IDA Pro](<https://hex-rays.com/blog/tag/ida-pro>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>)

# Plugin focus: SK3wldbg

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/plugin-focus-sk3wldbg>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/plugin-focus-sk3wldbg>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/plugin-focus-sk3wldbg>)

A 

Alex Petrov ✦ Posted: Mar 20, 2023

![Plugin focus: SK3wldbg](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-52-18-9716-AM.png)

**This is a guest entry written by Chris Eagle. His views and opinions are his own and not those of Hex-Rays. Any technical or maintenance issues regarding the code herein should be directed to the author.**

## The SK3wldbg Plugin

When I first started analyzing obfuscated code, I quite often wished that I could simply de-obfuscate the code within IDA without the need to run the code under debugger control, capture modified memory regions, and finally copy the modified blocks back into IDA in order to disassemble and analyze the, now de-obfuscated, code.

In 2002, IDA did not yet have a built-in debugger, and IDAPython was still a few years away. Many of my initial efforts to perform deobfuscation involved writing IDC scripts to mimic the behavior of the de-obfuscation routines while writing changes back into the IDA database. When the scripts were finished, I could simply disassemble the modified bytes that were present in IDA. I still have an IDC script that will unpack UPX in place.

I quickly realized that if I’d had an x86 emulator that used IDA as its memory store, I could stop writing new scripts and just run the emulator whenever I encountered obfuscated code. Thus was born the [x86emu plugin](<https://github.com/cseagle/x86emu>).

![](https://hex-rays.com/hubfs/Imported_Blog_Media/x86emu-3.png)

At the time, I didn’t really want to write an x86 emulator from scratch, and I searched for existing emulators that I could modify to suit my purposes. QEMU was the most likely candidate at the time but was almost too fully featured as I had no interest in anything other than the instruction set emulator, and I did not want to invest the time to remove all of the hardware support that QEMU provided.

Fast forward to 2015 and the release of the [Unicorn Engine](<https://www.unicorn-engine.org/>). The developers of Unicorn did exactly what I had elected not to do 12 years earlier, they ripped the hardware support out of QEMU and were able to release a tool that allowed for the easy creation of emulators for most architectures supported by QEMU. In the meantime, Hex-Rays had begun shipping GUI versions of IDA for Linux and OS X in addition to Windows, as well as local and remote debuggers for each of those platforms, including a Bochs-based emulation plugin that provided a native IDA debugging interface to a Bochs emulation of code loaded in IDA.

I decided that the time had come to revisit my effort to bake an emulator into IDA and Unicorn would serve as the core of a new debugger plugin – skw3ldbg.

## Debugger Plugins

Most people are familiar on some level with IDA plugins. What people may not be as familiar with is the fact that there are roughly four broad categories of plugin types (FIX, PROC, DBG, and “normal”). Those interested in the finer points should refer to loader.hpp from the IDA SDK for more information about the distinction between each type. Across the IDA plugin ecosystem, “normal” plugins are by far the most common among those that are publicly available.

A debugger (DBG) plugin is specifically designed to facilitate communications between IDA and a debugger being used to run the code you have loaded in IDA. Each of the debuggers that ships with IDA is implemented as debugger plugins and includes local native debuggers for Windows, Linux, and OS X as well as shims that allow IDA to communicate with existing debuggers (WinDbg and gdbserver) or one of Hex-Rays remote debugging servers available for several platforms.

All standard debugging features are available when using these plugins, such as launching new processes, attaching to existing processes, breakpoint manipulating, including hardware and software breakpoint handling as well as arbitrarily complex conditional breakpoints. Debugger plugins need not concern themselves with how information is presented to the user, Hex-Rays has already created a standard set of displays used across all debugger plugins. Instead, each debugger plugin is responsible for furnishing IDA with the information necessary to populate the displays of interest to the IDA user, such as register and memory contents and thread and module-related data. As a result, using any debugger plugin provides a uniform debugging experience regardless of the debugging back end you happen to be communicating with.

### Debugging with Bochs as a model emulation

Unique among the Hex-Rays provided debugger plugins is one that allows x86 code to be loaded into a Bochs emulation which is then controlled by the provided IDA debugging interface. No attempt is made to provide a full execution environment for the code that you wish to emulate. In the simplest case, the IDA’s Bochs debugger plugin simply maps the content of your IDA database into Bochs’ memory regions, allocates stack regions in Bochs, initializes registers with some sane defaults, then allows Bochs to begin the emulation. There are some significant limitations to the fidelity of the emulation, however as no additional binaries required by the process, such as libc.so or kernel32.dll are loaded into Bochs, nor does Bochs have access to a kernel that might be capable of handling system calls made by the process under emulation.

Please refer to [Debugging with Bochs](<https://www.hex-rays.com/wp-content/uploads/2019/12/debugging_bochs.pdf>) and [Boch’s Help](<https://www.hex-rays.com/products/ida/support/idadoc/1329.shtml>) for more information on debugging with IDA and Bochs.

## Sk3wldbg

With the Hex-Rays Bochs debugger as a model for emulation-based debugging in IDA, all I needed was the ability to emulate many instruction sets, which became a reality with the release of the Unicorn Engine.

![](https://hex-rays.com/hubfs/Imported_Blog_Media/sk3wldbg-3.png)

Debugger plugins must instantiate a `debugger_t` object and then set the global `dbg` pointer in IDA to point to the `debugger_t` instance. The majority of the implementation of a debugger is implemented in a mandatory callback function that processes more than 40 debugger-related notification messages. Fortunately, Hex-Rays provides a large amount of debugger-related example code as part of the IDA SDK to assist in understanding the required behaviors.

In the sk3wldbg implementation, `debugger_t` is subclassed for Unicorn-specific behaviors, then subclassed again for each architecture supported by Unicorn. When IDA is operating on a binary whose processor is supported by Unicorn, an appropriate debugger instance is constructed based on the current processor module, and Sk3wldbg will be listed as an available debugger option. When execution begins, sk3wldbg attempts to map and load the original disk file into Unicorn memory space using crude PE or ELF loaders. For other file types, sk3wldbg maps and loads the Unicorn memory space using segment information and content from IDA. In both cases, a stack region is mapped into Unicorn, and initial register values are assigned. Emulation occurs in a separate IDA qthread and synchronization is performed using a shared event queue and IDA qsemaphore objects.

Once execution begins, the user experience is similar to that of using any of IDA’s other debuggers, including the use of breakpoints, execution controls, and the ability to take memory snapshots. Breakpoints more closely resemble hardware breakpoints (software breakpoints are not inserted in the Unicorn memory space), and they are monitored by hooking the execution of each instruction in the execution thread. 

## Installation

Sk3wldbg is available on [GitHub](<https://github.com/cseagle/sk3wldbg>) using the supplied Makefile or Visual Studio solution file. Copy the resulting plugin (sk3wldbg_user) into IDA’s plugins directory and make sure that you have Unicorn installed on your system and if all goes well, sk3wldbg will show up and be available in IDA as a debugger option. 

![](https://hex-rays.com/hubfs/Imported_Blog_Media/select-3.png)

## Usage

After choosing Sk3wldbg as your debugger and setting some breakpoints, launch a debugging session using `Debugger/Start process` or the Start process toolbar button. Sk3wldbg asks where execution should begin.

![](https://hex-rays.com/hubfs/Imported_Blog_Media/start-3.png)

Select either the cursor location or the program entry point as your initial program counter value and control execution as you would any other process that you are debugging. NOTE: It is a good idea to set a breakpoint near the execution start point in order to make sure that you gain control over the emulation.

## Limitations

  * Sk3wldbg can only execute code that is present in your IDA database. It cannot currently follow execution into shared libraries or handle system calls.
  * None of the notifications required to support the Appcall interface are currently implemented.

---

## 8. 

**Date:** Posted: Mar 17, 2023  
**Link:** [https://hex-rays.com/blog/igors-tip-of-the-week-132-finding-hidden-cross-references](https://hex-rays.com/blog/igors-tip-of-the-week-132-finding-hidden-cross-references)

[Back](<https://hex-rays.com/blog>)

[idapro](<https://hex-rays.com/blog/tag/idapro>) [shortcuts](<https://hex-rays.com/blog/tag/shortcuts>) [idatips](<https://hex-rays.com/blog/tag/idatips>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>)

# Igor’s Tip of the Week #132: Finding “hidden” cross-references

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/igors-tip-of-the-week-132-finding-hidden-cross-references>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/igors-tip-of-the-week-132-finding-hidden-cross-references>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/igors-tip-of-the-week-132-finding-hidden-cross-references>)

I 

Igor Skochinsky ✦ Posted: Mar 17, 2023

![Igor’s Tip of the Week #132: Finding “hidden” cross-references](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-44-11-9294-AM.png)

When analyzing firmware or other binaries without metadata, IDA is not always able to discover and analyze all functions which means the cross-references can be missing. Let’s say you found a string in the binary (e.g. in the [String list](<https://hex-rays.com/blog/igors-tip-of-the-week-128-strings-list/>)) which has no cross references, but you’re reasonably sure it’s actually used. How to discover where?

### Finding addresses using binary search

One possibility is that the string is referred to by its address value, either from a pointer somewhere, or as an immediate value embedded directly in the instruction (the latter case is more common for CISC instruction sets such as x86). In such case, looking for the address value should discover it.

For example, here’s a string in an ARM firmware which currently has no cross-references:

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref1-3.png?width=1202&height=375&name=hidxref1-3.png)

We can try the following:

  1. Select and copy to clipboard the string’s address (`C3E31B49`);
  2. Go to the start of the database (`Ctrl`–`PgUp` or `Home`, `Home`, `Home`);
  3. Invoke binary search (Search > Sequence of bytes…, or `Alt`–`B`);
  4. Paste the address and make sure that _Hex_ is selected. It is also recommended to enable _Match case_ to avoid false positives:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref2-3.png?width=515&height=346&name=hidxref2-3.png)
  5. Click OK. IDA will automatically convert the value into a byte sequence corresponding to the processor endianness and look for it in the database:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref3-3.png?width=605&height=120&name=hidxref3-3.png)



The value may be initially displayed as a raw number or even separate bytes. To convert it to an offset so that xref is created you can usually use the `O` or `Ctrl`–`O` shortcuts, or the context menu:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref4-3.png?width=973&height=228&name=hidxref4-3.png)

Now the string has a cross-reference and you can look further at where exactly it is used:  
![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref5-3.png?width=1136&height=122&name=hidxref5-3.png)

### Finding addresses using immediate search

Binary search works for addresses embedded as-is into the binary. However, there may be situations where an address is embedded into an instruction not on a byte boundary, or split between several instructions. For example, RISC-V usually has to use at least two instructions to load a 32-bit value into a register (high 20 bits and low 12 bits). In case these instructions are next to each other, IDA can combine them into a single macroinstruction and calculate the full value, but because it’s split between two instructions, binary search won’t find it. However, immediate search (Search > Immediate value…, or `Alt`–`I`) should work. Note that if you copy the address from the listing, you’ll need to add 0x so that it can be parsed as hexadecimal by IDA.

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref6-3.png?width=389&height=387&name=hidxref6-3.png)

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/hidxref7-3.png?width=1195&height=183&name=hidxref7-3.png)

NOTE: this approach will succeed only under the following conditions:

  1. the instruction(s) using the address were actually decoded. You can try the approach described in [Tip #04](<https://hex-rays.com/blog/igor-tip-of-the-week-04-more-selection/>) to try disassembling the whole binary before looking for cross-references;
  2. the instructions were actually combined into a macro with the full address. For example, if they are interleaved with unrelated instructions, IDA won’t be able to combine them and you may need to look for each part separately.



Unfortunately, even the methods described here are not always enough. For example, [self-relative offsets](<https://hex-rays.com/blog/igors-tip-of-the-week-110-self-relative-offsets/>) will likely require analyzing the code to figure out what they refer to.

See also: 

[Igor’s tip of the week #95: Offsets](<https://hex-rays.com/blog/igors-tip-of-the-week-95-offsets/>)

[Igor’s Tip of the Week #114: Split offsets](<https://hex-rays.com/blog/igors-tip-of-the-week-114-split-offsets/>)

---

## 9. 

**Date:** Posted: Mar 10, 2023  
**Link:** [https://hex-rays.com/blog/igors-tip-of-the-week-131-advanced-filters-in-choosers](https://hex-rays.com/blog/igors-tip-of-the-week-131-advanced-filters-in-choosers)

[Back](<https://hex-rays.com/blog>)

[idapro](<https://hex-rays.com/blog/tag/idapro>) [shortcuts](<https://hex-rays.com/blog/tag/shortcuts>) [idatips](<https://hex-rays.com/blog/tag/idatips>) [Igor's tip of the week](<https://hex-rays.com/blog/tag/igors-tip-of-the-week>)

# Igor’s Tip of the Week #131: Advanced filters in choosers

Copy link [ ](<https://twitter.com/intent/tweet?text=https://hex-rays.com/blog/igors-tip-of-the-week-131-advanced-filters-in-choosers>) [ ](<https://mastodon.social/share?text=%20https://hex-rays.com/blog/igors-tip-of-the-week-131-advanced-filters-in-choosers>) [ ](<https://www.linkedin.com/shareArticle?mini=true&url=https://hex-rays.com/blog/igors-tip-of-the-week-131-advanced-filters-in-choosers>)

I 

Igor Skochinsky ✦ Posted: Mar 10, 2023

![Igor’s Tip of the Week #131: Advanced filters in choosers](https://hex-rays.com/hubfs/Imported_Blog_Media/bg-banner-Jun-18-2024-08-52-18-9716-AM.png)

We’ve covered choosers [previously](<https://hex-rays.com/blog/igors-tip-of-the-week-36-working-with-list-views-in-ida/>) and talked about searching, sorting and filtering. The default filter (`Ctrl`–`F` shortcut) is pretty simple: it performs case-insensitive match on any column of the list.

### Advanced filters 

Advanced filter dialog is accessible via the context menu entry “Modify filters…” or the shortcut `Ctrl`–`Shift`–`F`

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/advfilter1-3.png?width=391&height=575&name=advfilter1-3.png) ![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/advfilter2-3.png?width=905&height=410&name=advfilter2-3.png)

In the dialog you can:

  * match any or a specific column;
  * perform an exact match (is/is not) or partial (contains/doesn’t contain, begins/ends with);
  * perform a lexicographical comparison (less than/more than);
  * decide whether a specific filter excludes, includes, or highlights matches;
  * disable and enable filters individually;
  * use case-sensitive matching or regular expressions.



### Examples

The following set of filters excludes functions which start with `sub_`, or situated in segments `extern` (external functions) and `.plt` (PLT thunks for external functions). This way only the functions defined inside the binary which have non-[dummy names](<https://hex-rays.com/blog/igors-tip-of-the-week-34-dummy-names/>) are shown:

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/advfilter3-3.png?width=1224&height=507&name=advfilter3-3.png)

Highlight any function with name ending in _NNN where NNN is a sequence of decimal numbers:

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/advfilter4-3.png?width=1493&height=530&name=advfilter4-3.png)

The highlight color can be changed by clicking the “Highlight button”.

Show only functions which were detected by IDA as [non-returning](<https://hex-rays.com/blog/igors-tip-of-the-week-126-non-returning-functions/>):

![](https://hex-rays.com/hs-fs/hubfs/Imported_Blog_Media/advfilter5-3.png?width=1651&height=488&name=advfilter5-3.png)

NOTE: the examples listed apply to the Functions list but these filters are available in any chooser (list view) in IDA: Imports, Exports, Names, Local Types etc.

See also:

[Igor’s tip of the week #36: Working with list views in IDA](<https://hex-rays.com/blog/igors-tip-of-the-week-36-working-with-list-views-in-ida/>)

---

